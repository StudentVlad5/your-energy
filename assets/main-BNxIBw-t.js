import{a as le,i as te}from"./vendor-3BNOZKAJ.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();(()=>{const e={openMenuBtn:document.querySelector("[data-menu-open]"),closeMenuBtn:document.querySelector("[data-menu-close]"),menu:document.querySelector("[data-menu]")};if(!e.openMenuBtn||!e.menu||!e.closeMenuBtn)return;const t=()=>{e.menu.classList.toggle("is-open"),document.body.classList.toggle("menu-open")};e.openMenuBtn.addEventListener("click",t),e.closeMenuBtn.addEventListener("click",t),window.matchMedia("(min-width: 768px)").addEventListener("change",n=>{n.matches&&(e.menu.classList.remove("is-open"),document.body.classList.remove("menu-open"))})})();const A={loaderOverlay:document.getElementById("loader-overlay"),loaderBg:document.getElementById("bg-loader")};function K(){A.loaderOverlay&&A.loaderOverlay.classList.add("hidden"),A.loaderBg&&A.loaderBg.classList.remove("bg-loader")}let c=null,V=!1;const B={};function de(e,t,n){B[e]={getContent:t,init:n}}function b(){V||(c={modal:document.getElementById("modal-template"),backdrop:document.querySelector("[data-modal-close]"),closeBtn:document.querySelector(".modal-template__close-btn"),body:document.querySelector("[data-modal-body]")},V=!0)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{b()}):b();function ue(){document.querySelectorAll("[data-modal]").forEach(t=>{if(t.hasAttribute("data-modal-initialized"))return;const n=t.getAttribute("data-modal");if(!B[n]){console.warn(`Modal type "${n}" is not registered`);return}t.addEventListener("click",()=>{const{getContent:i,init:o}=B[n],r=i();if(!r){console.error(`Failed to get content for modal type "${n}"`);return}me(r),o&&setTimeout(async()=>{try{await o(M)}catch(a){console.error("Error initializing modal:",a)}},100)}),t.setAttribute("data-modal-initialized","true")})}function me(e){var t,n;if(b(),!c||!c.modal||!c.body){console.error("Modal template elements not found");return}if(typeof e=="string")c.body.innerHTML=e;else if(e instanceof HTMLElement)c.body.innerHTML="",c.body.appendChild(e);else{console.error("Invalid content type. Expected string or HTMLElement");return}c.modal.classList.remove("hidden"),document.body.classList.add("modal-open"),document.addEventListener("keydown",ne,{once:!1}),(t=c.backdrop)==null||t.addEventListener("click",oe),(n=c.closeBtn)==null||n.addEventListener("click",re)}function M(){var e,t;b(),!(!c||!c.modal)&&(c.modal.classList.add("hidden"),document.body.classList.remove("modal-open"),document.removeEventListener("keydown",ne),(e=c.backdrop)==null||e.removeEventListener("click",oe),(t=c.closeBtn)==null||t.removeEventListener("click",re),c&&c.body&&(c.body.innerHTML=""))}function x(){const e=document.getElementById("modal-confirm");return e&&!e.classList.contains("hidden")}function ne(e){if(e.key==="Escape"){if(x())return;M()}}function oe(e){if(e.target===c.backdrop){if(x())return;M()}}function re(){x()||M()}const m={WHITE:"#fff",BLACK:"#000",GRAY_LIGHT:"#808080"},T={FILTERS:"/filters",EXERCISES:"/exercises",QUOTE:"/quote",SUBSCRIPTION:"/subscription"},fe={EMAIL:/^[^\s@]+@[^\s@]+\.[^\s@]+$/},h={EMAIL_REGEX:fe.EMAIL,RATING_MIN:1,RATING_MAX:5},g={POSITION:{TOP_RIGHT:"topRight",TOP_LEFT:"topLeft",TOP_CENTER:"topCenter",BOTTOM_RIGHT:"bottomRight",BOTTOM_LEFT:"bottomLeft",BOTTOM_CENTER:"bottomCenter"},TIMEOUT:{SHORT:2e3,DEFAULT:4e3,LONG:6e3},TRANSITION:{IN:"fadeInLeft",OUT:"fadeOutRight"},TITLE:{SUCCESS:"OK",ERROR:"Error",INFO:"Info",WARNING:"Warning"},ICON:{SUCCESS:"icon-check",ERROR:"icon-error",INFO:"icon-info",WARNING:"icon-warning"}},Ee={RATING:"rating",EXERCISE:"exercise"},R={API_ERROR:"Something went wrong",EMAIL_REQUIRED:"Valid email is required",RATING_RANGE:`Rating must be between ${h.RATING_MIN} and ${h.RATING_MAX}`,EXERCISE_ID_REQUIRED:"Exercise ID is required"},ge={BASE_API_URL:"https://your-energy.b.goit.study/api",DEV_HOST:"127.0.0.1",DEV_PORT:"3000",BASE_PATH:"/your-energy/"};class pe{constructor(t=ge.BASE_API_URL){this.baseURL=t,this.axios=le.create({baseURL:this.baseURL}),this.axios.interceptors.response.use(n=>n,n=>{var o,r;const i=((r=(o=n.response)==null?void 0:o.data)==null?void 0:r.message)||n.message||R.API_ERROR;return console.error("API Error:",i),Promise.reject(n)})}async _request(t,n,i=null,o=null){var r,a;try{const u={method:t,url:n};return i&&(u.data=i),o&&(u.params=o),(await this.axios(u)).data}catch(u){const d=((a=(r=u.response)==null?void 0:r.data)==null?void 0:a.message)||u.message;throw new Error(`${t.toUpperCase()} ${n} failed: ${d}`)}}async getFilters(t={}){return this._request("get",T.FILTERS,null,t)}async getExercises(t={}){return this._request("get",T.EXERCISES,null,t)}async getExerciseById(t){if(!t)throw new Error(R.EXERCISE_ID_REQUIRED);return this._request("get",`${T.EXERCISES}/${t}`)}async getQuote(){return this._request("get",T.QUOTE)}async subscribe(t){if(!t.email||!h.EMAIL_REGEX.test(t.email))throw new Error(R.EMAIL_REQUIRED);return this._request("post",T.SUBSCRIPTION,t)}async rateExercise(t,n){if(!t)throw new Error(R.EXERCISE_ID_REQUIRED);if(!n.rate||n.rate<h.RATING_MIN||n.rate>h.RATING_MAX)throw new Error(R.RATING_RANGE);if(!n.email||!h.EMAIL_REGEX.test(n.email))throw new Error(R.EMAIL_REQUIRED);return this._request("patch",`${T.EXERCISES}/${t}/rating`,n)}}const ie={position:g.POSITION.TOP_RIGHT,timeout:g.TIMEOUT.DEFAULT,close:!0,closeOnEscape:!0,pauseOnHover:!0,progressBar:!0,progressBarColor:m.GRAY_LIGHT,transitionIn:g.TRANSITION.IN,transitionOut:g.TRANSITION.OUT,fontFamily:"inherit",icon:""},Ie=e=>{te.show({...ie,title:g.TITLE.SUCCESS,message:e,backgroundColor:m.BLACK,titleColor:m.WHITE,messageColor:m.WHITE,icon:g.ICON.SUCCESS,iconColor:m.WHITE})},N=e=>{te.show({...ie,title:g.TITLE.ERROR,message:e,backgroundColor:m.BLACK,titleColor:m.WHITE,messageColor:m.GRAY_LIGHT,progressBarColor:m.WHITE,icon:g.ICON.ERROR,iconColor:m.WHITE})};let l=null,P=null,G=null;function w(){var t,n,i,o,r,a;if(l)return;const e=document.getElementById("modal-confirm");if(!e){console.error("Confirm modal not found");return}l={modal:e,backdrop:e.querySelector("[data-confirm-close]"),message:e.querySelector("[data-confirm-message]"),cancelBtn:e.querySelector("[data-confirm-cancel]"),confirmBtn:e.querySelector("[data-confirm-ok]")},(t=l.backdrop)==null||t.removeEventListener("click",Y,{capture:!0}),(n=l.cancelBtn)==null||n.removeEventListener("click",_,{capture:!0}),(i=l.confirmBtn)==null||i.removeEventListener("click",j,{capture:!0}),(o=l.backdrop)==null||o.addEventListener("click",Y,{capture:!0}),(r=l.cancelBtn)==null||r.addEventListener("click",_,{capture:!0}),(a=l.confirmBtn)==null||a.addEventListener("click",j,{capture:!0})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",w):w();function ye(e){e.key==="Escape"&&l&&!l.modal.classList.contains("hidden")&&_()}function Y(e){e.target===l.backdrop&&(e.stopPropagation(),e.preventDefault(),_(e))}function _(e){e&&(e.stopPropagation(),e.preventDefault());const t=G;ae(),t&&t()}function j(e){e&&(e.stopPropagation(),e.preventDefault());const t=P;ae(),setTimeout(()=>{t&&t()},0)}function Re(e,t,n=null){if(w(),!l||!l.modal){console.error("Confirm modal elements not found");return}P=t,G=n,l.message&&(l.message.textContent=e),l.modal.classList.remove("hidden"),document.addEventListener("keydown",ye,{once:!0})}function ae(){!l||!l.modal||(l.modal.classList.add("hidden"),P=null,G=null)}const Le=new pe;let L=null;function Se(){const e=document.querySelector(".rating-modal");if(!e)return console.error("Rating modal HTML not found. Make sure modal-rating.html is loaded via <load> tag."),null;const t=e.cloneNode(!0);return Te(t),t}function J(){document.addEventListener("click",function(e){const t=e.target.closest('[data-modal="rating"]');if(t){const n=t.getAttribute("data-exercise-id");n&&sessionStorage.setItem("ratingModalExerciseId",n)}},{capture:!0})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",J):J();function Te(e){const t=e.querySelectorAll("[id]"),n=Date.now();t.forEach(i=>{const o=i.id;i.id=`${o}-${n}`,e.querySelectorAll(`label[for="${o}"]`).forEach(a=>{a.setAttribute("for",i.id)})})}function Z(){const e=document.querySelector("[data-modal-body]"),t=e==null?void 0:e.querySelector(".rating-modal");if(!t)return;const n=t.querySelector(".rating-modal__form"),i=t.querySelector('input[name="rating"]'),o=t.querySelector(".rating-modal__rating-text"),r=t.querySelector('input[name="email"]'),a=t.querySelector('textarea[name="comment"]'),u=t.querySelectorAll(".rating-star");n&&n.reset(),i&&(i.value="0"),r&&(r.value=""),a&&(a.value=""),o&&(o.textContent=""),u.forEach(d=>{d.classList.remove("active")})}function q(e){L&&L()?Re("Are you sure you want to cancel your exercise review?",()=>{Z(),L=null,e()},()=>{}):(Z(),L=null,e())}function he(e){var W;L=null;const t=document.querySelector("[data-modal-body]"),n=t==null?void 0:t.querySelector(".rating-modal");if(!t||!n){console.error("Modal body or rating modal not found");return}let i=sessionStorage.getItem("ratingModalExerciseId")||((W=document.querySelector('[data-modal="rating"][data-exercise-id]'))==null?void 0:W.getAttribute("data-exercise-id"));if(i&&sessionStorage.removeItem("ratingModalExerciseId"),!i){N("Exercise ID is missing");return}const o=n.querySelectorAll(".rating-star"),r=n.querySelector('input[name="rating"]'),a=n.querySelector(".rating-modal__rating-text"),u=n.querySelector(".rating-modal__btn--cancel"),d=n.querySelector('.rating-modal__btn[type="submit"]'),p=n.querySelector('input[name="email"]'),I=n.querySelector('textarea[name="comment"]'),C=n.querySelector(".rating-modal__form");let O=0;d&&(d.disabled=!0),r&&(r.value="0"),a&&(a.textContent="0");const D=()=>O>0&&O<=5&&(p==null?void 0:p.value.trim())!==""&&(I==null?void 0:I.value.trim())!=="",U=()=>{d&&(d.disabled=!D())};L=()=>O>0||(p==null?void 0:p.value.trim())!==""||(I==null?void 0:I.value.trim())!=="";const se=s=>{o.forEach((f,E)=>{E+1<=s?f.classList.add("active"):f.classList.remove("active")})};o.forEach((s,f)=>{const E=f+1;s.addEventListener("click",()=>{O=E,se(E),r&&(r.value=E),a&&(a.textContent=E),U()})}),[p,I].forEach(s=>{s&&s.addEventListener("input",U)});const y=document.querySelector("[data-modal-close]"),k=()=>{const s=document.getElementById("modal-confirm");return s&&!s.classList.contains("hidden")},H=s=>{if(s.key==="Escape"){if(k())return;s.stopPropagation(),q(()=>{v(),e()})}},F=s=>{if(s.target===y){if(k())return;s.stopPropagation(),q(()=>{v(),e()})}},v=()=>{document.removeEventListener("keydown",H,{capture:!0}),y==null||y.removeEventListener("click",F,{capture:!0}),S==null||S.removeEventListener("click",$,{capture:!0})},S=document.querySelector(".modal-template__close-btn"),$=s=>{k()||(s.stopPropagation(),X())};document.addEventListener("keydown",H,{capture:!0}),y==null||y.addEventListener("click",F,{capture:!0}),S==null||S.addEventListener("click",$,{capture:!0});const X=()=>{q(()=>{v(),e()})};u&&e&&u.addEventListener("click",()=>{X()}),C&&(C.setAttribute("data-no-auto-close","true"),C.addEventListener("submit",async s=>{if(s.preventDefault(),!D()){N("Please fill in all fields");return}const f=new FormData(C),E=parseInt(f.get("rating"),10),Q=f.get("email").trim(),ce=f.get("comment").trim();d&&(d.disabled=!0,d.textContent="Sending...");try{await Le.rateExercise(i,{rate:E,email:Q,review:ce}),Ie("Thank you for your feedback!"),L=null,setTimeout(()=>{e&&(v(),e())},1e3)}catch(z){console.error("Failed to submit rating:",z),N(z.message||R.API_ERROR),d&&(d.disabled=!1,d.textContent="Send")}}))}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{K(),ee()}):(K(),ee());function ee(){de(Ee.RATING,Se,he),ue()}
//# sourceMappingURL=main-BNxIBw-t.js.map
